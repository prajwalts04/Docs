<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Upload PDF</title>
  <style>
    body {
      margin: 0;
      background: #eef3ff;
      font-family: Arial, sans-serif;
    }

    .container {
      max-width: 450px;
      margin: 20px auto;
      background: #fff;
      padding: 22px;
      border-radius: 14px;
      box-shadow: 0 3px 14px rgba(0,0,0,0.18);
    }

    h2 {
      text-align: center;
      color: #003d99;
    }

    label {
      font-weight: 600;
    }

    input {
      width: 100%;
      padding: 12px;
      border: 1px solid #b9c7e8;
      border-radius: 10px;
      margin-top: 6px;
      margin-bottom: 8px;
      background: #f7f9ff;
    }

    .error {
      color: red;
      font-size: 13px;
      display: none;
      margin-bottom: 10px;
    }

    button {
      width: 100%;
      padding: 14px;
      background: #0055ff;
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 17px;
      font-weight: bold;
      margin-top: 12px;
    }

    button:disabled {
      background: #a7bdf8;
    }

    #progressArea {
      margin-top: 20px;
      display: none;
    }

    .progressBarBg {
      width: 100%;
      background: #dce4ff;
      border-radius: 20px;
      height: 14px;
    }

    #progressBar {
      width: 0%;
      height: 14px;
      background: #00b341;
      border-radius: 20px;
      transition: width 0.3s ease;
    }

    #statusText {
      text-align: center;
      margin-top: 10px;
      font-weight: bold;
      color: #003d99;
    }

    #msg {
      text-align: center;
      margin-top: 15px;
      font-weight: bold;
      color: green;
    }
  </style>
</head>

<body>

<div class="container">

  <h2>Upload Your PDF</h2>

  <label>Name</label>
  <input type="text" id="name" oninput="validateForm()">
  <div id="nameErr" class="error">Name is required</div>

  <label>Contact Number</label>
  <input type="text" id="contact" oninput="validateForm()">
  <div id="contactErr" class="error">Contact number is required</div>

  <label>Select PDF Document</label>
  <input type="file" accept="application/pdf" id="file" onchange="validateForm()">

  <button id="uploadBtn" onclick="upload()" disabled>Upload PDF</button>

  <div id="progressArea">
    <div class="progressBarBg">
      <div id="progressBar"></div>
    </div>
    <div id="statusText">Uploading...</div>
  </div>

  <div id="msg"></div>
</div>

<script>
function validateForm() {
  const name = document.getElementById("name").value.trim();
  const contact = document.getElementById("contact").value.trim();
  const file = document.getElementById("file").files.length;

  document.getElementById("nameErr").style.display = name ? "none" : "block";
  document.getElementById("contactErr").style.display = contact ? "none" : "block";

  document.getElementById("uploadBtn").disabled = !(name && contact && file);
}

function upload() {
  const name = document.getElementById("name").value.trim();
  const contact = document.getElementById("contact").value.trim();
  const file = document.getElementById("file").files[0];

  document.getElementById("progressArea").style.display = "block";
  const bar = document.getElementById("progressBar");
  const statusText = document.getElementById("statusText");

  let progress = 0;

  const fake = setInterval(() => {
    progress = Math.min(progress + Math.random() * 10, 90);
    bar.style.width = progress + "%";
    statusText.innerHTML = "Uploading... " + Math.round(progress) + "%";

    if (progress >= 90) clearInterval(fake);
  }, 200);

  const reader = new FileReader();

  reader.onload = function(e) {
    const base64File = e.target.result.split(",")[1];

    google.script.run.withSuccessHandler(msg => {
      bar.style.width = "100%";
      statusText.innerHTML = "Upload Completed âœ”";
      document.getElementById("msg").innerHTML = msg;
    }).uploadFile({
      name: name,
      contact: contact,
      file: base64File
    });
  };

  reader.readAsDataURL(file);
}
</script>

</body>
</html>
